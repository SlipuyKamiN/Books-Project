{"mappings":"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","sources":["src/index.js","src/js/categories.js","src/js/home/allCategories.js"],"sourcesContent":["import './js/fetchBooks';\nimport './js/modal';\nimport './js/auth-modal';\nimport './js/scroll-up';\nimport './js/darkTheme';\nimport './js/categories';\nimport './js/home/allCategories';\nimport './js/support';\n\nimport './js/header';\nimport './js/auth';\n","// import transformer from 'parcel-transformer-hbs';\nimport { fetchBooks } from '../js/fetchBooks';\nimport { makeMarkupGategory, showAllCategories } from './home/allCategories';\n// import { handleImgClick } from './home/allCategories';\n// import { handleModalWindow } from './modal';\nimport { addEventListenerForBook } from './home/allCategories';\nimport { addEventListenerForBook } from './home/allCategories';\nimport { showAllCategories } from './home/allCategories';\n\nconst listEl = document.querySelector('.categories-list-js');\nconst mainListEl = document.querySelector('.main__list-js');\nconst mainTitle = document.querySelector('.main__title-js');\nconst allCategoriesBtn = document.querySelector('.all-categories-btn');\n\nallCategoriesBtn.classList.add('selected-categories');\n\nconst createCategoryList = async () => {\n  const categoriesList = await fetchBooks.getCategoriesList();\n\n  const makeNewButtons = categoriesList\n    .map(\n      category =>\n        `<li class= 'categories-list__item '> <button class= 'categories-list__button'>${category.list_name}</button> </li>`\n    )\n    .join('');\n  listEl.insertAdjacentHTML('beforeend', makeNewButtons);\n};\ncreateCategoryList();\n\n// allCategoriesBtn.addEventListener('click', showAllCategories);\n\nexport const drawCategory = async name => {\n  const books = await fetchBooks.getBooksByCategory(name);\n  const markup = makeMarkupGategory(books);\n  const titleArr = name.split(' ');\n  const titleFirstPart = titleArr.slice(0, titleArr.length - 1).join(' ');\n  const titleLastPart = titleArr.slice(titleArr.length - 1).join();\n  mainTitle.innerHTML = `${titleFirstPart}<span class=\"main__title--color-purple\"> ${titleLastPart}</span>`;\n  mainListEl.innerHTML = markup;\n  mainListEl.classList.add('card-set');\n  const bookCategoryEl = document.querySelectorAll('.category-books__item');\n  addEventListenerForBook(bookCategoryEl);\n  allCategoriesBtn.classList.remove('selected-categories');\n};\n\nlistEl.addEventListener('click', markup);\n\nlet previ = '';\nlet title = '';\n\nfunction markup(ev) {\n  if (ev.target.nodeName !== 'BUTTON') {\n    return;\n  }\n\n  clearSelectedCategories();\n\n  if (ev.target === allCategoriesBtn) {\n    allCategoriesBtn.classList.add('selected-categories');\n    // previ.classList.remove('selected-categories');\n    showAllCategories();\n    return;\n  }\n  title = ev.target.textContent;\n  drawCategory(title);\n\n  // if (previ !== '') {\n  //   previ.classList.remove('selected-categories');\n  // }\n  ev.target.classList.add('selected-categories');\n  // previ = ev.target;\n  // console.log(ev.target.nodeName);\n}\n\nconst clearSelectedCategories = () => {\n  for (let i = 0; i < listEl.children.length; i += 1) {\n    const category = listEl.children[i];\n\n    category.firstElementChild.classList.remove('selected-categories');\n  }\n};\n","import Notiflix from 'notiflix';\nimport { fetchBooks } from '../fetchBooks';\nimport { handleModalWindow } from '../modal';\nimport { drawCategory } from '../categories';\n\nconst mainTitleEl = document.querySelector('.main__title-js');\nconst mainWraperEl = document.querySelector('.main__list-js');\nlet currentRenderWidth = window.innerWidth;\nlet amountRenderBooks = 0;\nlet idBook = 0;\nlet title = 0;\n\nconst currentWindowWidth = () => {\n  if (currentRenderWidth < 768) {\n    amountRenderBooks = 1;\n  } else if (currentRenderWidth >= 768 && currentRenderWidth < 1440) {\n    amountRenderBooks = 3;\n  } else {\n    amountRenderBooks = 5;\n  }\n};\n\nconst validationQuery = query => {\n  if (query.length === 0) {\n    Notiflix.Notify.failure(\n      'Sorry, there was an error on the server. Please try again.'\n    );\n    return;\n  }\n\n  for (let i = 0; i < query.length; i += 1) {\n    const element = query[i];\n    if (element.books.length === 0) {\n      const fff = document.querySelector('.category-books__title');\n      console.log(fff);\n      Notiflix.Notify.info(\n        `Sorry, but no books found by category ${element.list_name}.`\n      );\n    }\n  }\n};\n\nconst makeMarkupAllCategories = categories => {\n  return categories\n    .map(category => {\n      return `\n           <li class='all-categories__item'>\n           <h4 class='category-books__title'>${category.list_name}</h4>\n            <ul class='category-books__list-js card-set'>\n           ${makeMarkupGategory(category.books)}\n           </ul>\n           <button class=\"load-more-js\" type=\"button\" data-category=\"${\n             category.list_name\n           }\">see more</button>\n           </li>\n      `;\n    })\n    .join('');\n};\n\nexport const makeMarkupGategory = category => {\n  return trimArrayBooks(category)\n    .map(book => {\n      return `\n      <li class='category-books__item'>\n       <a href=\"/\" class='category-books__link'>\n        <img\n          class='category-books__img'\n          src='${book.book_image}'\n          alt='book'\n          data-id=\"${book._id}\"\n         loading=\"lazy\"\n        />\n        <div class='category-books__wrapper'>\n        <p class='category-books__text'>quick view</p>\n        </div>\n        </a>\n        <h3 class='category-books__name' >${checkLengthBookTitle(\n          book.title,\n          18\n        )}</h3>\n        <p class='category-books__author'>${checkLengthBookTitle(\n          book.author,\n          29\n        )}</p>\n      </li>\n    `;\n    })\n    .join('');\n};\n\nasync function feachAllCategories() {\n  try {\n    const categories = await fetchBooks.getBestSellers();\n    validationQuery(categories);\n    mainWraperEl.innerHTML = makeMarkupAllCategories(categories);\n\n    const seeMoreBtnEl = document.querySelectorAll('.load-more-js');\n    const bookCategoryEl = document.querySelectorAll('.category-books__item');\n\n    addEventListenerForBook(bookCategoryEl);\n    addEventListenerForBtn(seeMoreBtnEl);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport const showAllCategories = () => {\n  mainTitleEl.innerHTML =\n    ' Best Sellers <span class=\"main__title--color-purple\">Books</span>';\n  feachAllCategories();\n};\n\nconst handleImgClick = event => {\n  event.preventDefault();\n  idBook = event.target.dataset.id;\n\n  if (event.target.nodeName !== 'IMG') {\n    return;\n  }\n  handleModalWindow(idBook);\n};\n\nconst handleSeeMoreBtnClick = event => {\n  title = event.target.dataset.category;\n\n  setCurrentCategory(title);\n  drawCategory(title);\n};\n\nexport const checkLengthBookTitle = (title, length) => {\n  if (title.length > length) {\n    return `${title.slice(0, length)}...`;\n  }\n\n  return title;\n};\n\nexport const addEventListenerForBook = book => {\n  book.forEach(el => {\n    el.addEventListener('click', handleImgClick);\n  });\n};\n\nconst addEventListenerForBtn = category => {\n  category.forEach(el => {\n    el.addEventListener('click', handleSeeMoreBtnClick);\n  });\n};\n\nconst setCurrentCategory = title => {\n  const categoriesListChildren = document.querySelector(\n    '.categories-list-js'\n  ).children;\n  for (let i = 0; i < categoriesListChildren.length; i += 1) {\n    const category = categoriesListChildren[i];\n\n    category.firstElementChild.classList.remove('selected-categories');\n\n    if (category.textContent.trim() === title.trim()) {\n      category.firstElementChild.classList.add('selected-categories');\n    }\n  }\n};\n\nconst trimArrayBooks = category => {\n  if (amountRenderBooks === 1) {\n    category.splice(1, 4);\n  } else if (amountRenderBooks === 3) {\n    category.splice(3, 2);\n  } else {\n    category;\n  }\n  return category;\n};\n\ncurrentWindowWidth();\nshowAllCategories();\n"],"names":["parcelRequire","$aWIP7","$7Y9D8","$61041978ae654dbc$var$mainTitleEl","document","querySelector","$61041978ae654dbc$var$mainWraperEl","$61041978ae654dbc$var$currentRenderWidth","window","innerWidth","$61041978ae654dbc$var$amountRenderBooks","$61041978ae654dbc$var$idBook","$61041978ae654dbc$var$title","$61041978ae654dbc$export$93242e041943582c","category","$61041978ae654dbc$var$trimArrayBooks","map","book","book_image","_id","$61041978ae654dbc$export$d0b4285b56c56ded","title","author","join","async","$61041978ae654dbc$var$feachAllCategories","categories","fetchBooks","getBestSellers","query","length","i","element","books","fff","console","log","$parcel$interopDefault","Notify","info","list_name","failure","$61041978ae654dbc$var$validationQuery","innerHTML","$61041978ae654dbc$var$makeMarkupAllCategories","seeMoreBtnEl","querySelectorAll","bookCategoryEl","$61041978ae654dbc$export$86c97e2bc749f2cb","$61041978ae654dbc$var$addEventListenerForBtn","error","$61041978ae654dbc$export$19ae0cb1595596b","$61041978ae654dbc$var$handleImgClick","event","preventDefault","target","dataset","id","nodeName","$bTcpz","handleModalWindow","$61041978ae654dbc$var$handleSeeMoreBtnClick","$61041978ae654dbc$var$setCurrentCategory","$f3b06000f9b46fbb$export$289350b6fddd83e8","slice","forEach","el","addEventListener","categoriesListChildren","children","firstElementChild","classList","remove","textContent","trim","add","splice","$f3b06000f9b46fbb$var$listEl","$f3b06000f9b46fbb$var$mainListEl","$f3b06000f9b46fbb$var$mainTitle","$f3b06000f9b46fbb$var$allCategoriesBtn","makeNewButtons","getCategoriesList","insertAdjacentHTML","$f3b06000f9b46fbb$var$createCategoryList","name","getBooksByCategory","markup","titleArr","split","titleFirstPart","titleLastPart","ev","$f3b06000f9b46fbb$var$clearSelectedCategories","$f3b06000f9b46fbb$var$title"],"version":3,"file":"index.b94ddfaf.js.map"}